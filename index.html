<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AetherScan - ÙØ§Ø­Øµ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø§Ù„Ø£ÙƒØ«Ø± Ø­Ø³Ø§Ø³ÙŠØ©</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        /* (*** Ø§Ù„Ø£Ù†Ù…Ø§Ø· CSS ÙƒÙ…Ø§ Ù‡ÙŠ Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± ***) */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #F8FAFC;
            color: #1F2937;
            text-align: right;
            padding: 20px;
        }
        .container {
            max-width: 700px;
            margin: 40px auto;
            background-color: #ffffff;
            padding: 40px;
            border-radius: 24px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #DC2626; /* Ø¬Ø¹Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø£Ø­Ù…Ø± Ù„ÙŠØ¹ÙƒØ³ Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ù‚ØµÙˆÙ‰ */
            font-size: 2.5em;
            font-weight: 800;
        }
        .subtitle {
            text-align: center;
            color: #6B7280;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }
        #urlInput {
            flex-grow: 1;
            padding: 18px;
            border: 2px solid #D1D5DB;
            border-radius: 12px;
            font-size: 17px;
            text-align: right;
            transition: border-color 0.3s;
        }
        #urlInput:focus {
            border-color: #DC2626; 
            outline: none;
        }
        #scanButton {
            background-color: #DC2626; /* Ø²Ø± Ø¨Ù„ÙˆÙ† Ø§Ù„Ø®Ø·Ø± */
            color: white;
            border: none;
            padding: 0 30px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 700;
            transition: background-color 0.3s, transform 0.1s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        #scanButton:hover {
            background-color: #B91C1C;
        }
        #scanButton:active {
            transform: scale(0.98);
        }
        #scanButton:disabled {
            background-color: #9CA3AF;
            cursor: not-allowed;
        }
        .result-box {
            padding: 25px;
            border-radius: 16px;
            margin-top: 25px;
            animation: fadeIn 0.6s ease-out;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            display: none;
        }
        .result-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .result-status {
            font-size: 1.8em;
            font-weight: 800;
        }
        .result-url {
            font-size: 1em;
            color: #6B7280;
            direction: ltr;
            text-align: left;
            word-break: break-all;
            margin-bottom: 15px;
        }
        .safe {
            background-color: #ECFDF5;
            border: 3px solid #10B981;
        }
        .safe .result-status {
            color: #059669;
        }
        .safe i {
            color: #059669;
        }
        .danger {
            background-color: #FEF2F2;
            border: 3px solid #EF4444;
        }
        .danger .result-status {
            color: #DC2626;
        }
        .danger i {
            color: #DC2626;
        }
        .details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        .detail-item {
            background-color: #F3F4F6;
            padding: 15px;
            border-radius: 10px;
            font-size: 0.95em;
        }
        .detail-label {
            color: #6B7280;
            font-weight: 600;
            margin-bottom: 5px;
            display: block;
        }
        .detail-value {
            font-weight: 700;
            color: #1F2937;
        }
        .warnings-list {
            margin-top: 14px;
            padding: 14px;
            background-color: #FEE2F2;
            border: 1px solid #FCA5A5;
            border-radius: 10px;
        }
        .warnings-title {
            color: #DC2626;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .warnings-list ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .warnings-list li {
            color: #991B1B;
            margin-bottom: 8px;
            position: relative;
            padding-right: 15px;
        }
        .warnings-list li::before {
            content: 'â€¢';
            color: #DC2626;
            font-size: 1.2em;
            position: absolute;
            right: 0;
            top: 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

<div class="container">
    <div style="text-align: center;">
        <h1><i class="fas fa-biohazard"></i> AetherScan Extreme</h1>
        <p class="subtitle">Ù†Ø¸Ø§Ù… ÙƒØ´Ù Ø§Ù„Ø£Ù…Ø§Ù† Ø¨Ø­Ø³Ø§Ø³ÙŠØ© Ù‚ØµÙˆÙ‰ (Ø£ÙŠ ØªØºÙŠÙŠØ± ÙŠØ¹ØªØ¨Ø± Ø®Ø·Ø±)</p>
    </div>

    <div class="input-group">
        <input type="url" id="urlInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· ÙƒØ§Ù…Ù„Ø§Ù‹ Ù‡Ù†Ø§..." value="" />
        <button id="scanButton"><i class="fas fa-skull-crossbones"></i> ÙØ­Øµ Ø¹Ø¯ÙˆØ§Ù†ÙŠ</button>
    </div>

    <div id="resultBox" class="result-box">
        </div>
</div>

<script>
    // ********* Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ù…Ø³Ø§ÙØ© Ù„ÙŠÙÙ†Ø´ØªØ§ÙŠÙ† (Levenshtein Distance) *********
    function getEditDistance(a, b) {
      if (a.length === 0) return b.length;
      if (b.length === 0) return a.length;

      const matrix = [];

      for (let i = 0; i <= b.length; i++) {
        matrix[i] = [i];
      }

      for (let j = 0; j <= a.length; j++) {
        matrix[0][j] = j;
      }

      for (let i = 1; i <= b.length; i++) {
        for (let j = 1; j <= a.length; j++) {
          if (b.charAt(i - 1) === a.charAt(j - 1)) {
            matrix[i][j] = matrix[i - 1][j - 1];
          } else {
            matrix[i][j] = Math.min(
              matrix[i - 1][j - 1] + 1, // Ø§Ø³ØªØ¨Ø¯Ø§Ù„
              matrix[i][j - 1] + 1, // Ø¥Ø¯Ø®Ø§Ù„
              matrix[i - 1][j] + 1 // Ø­Ø°Ù
            );
          }
        }
      }

      return matrix[b.length][a.length];
    }
    // *******************************************************************


    const urlInput = document.getElementById('urlInput');
    const scanButton = document.getElementById('scanButton');
    const resultBox = document.getElementById('resultBox');

    scanButton.addEventListener('click', handleScan);

    function parseUrl(url) {
        try {
            // Ø¥Ø¶Ø§ÙØ© https:// Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¯ÙˆÙ† Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„
            const link = url.startsWith('http') ? url : `https://${url}`;
            const parsed = new URL(link);
            return {
                fullUrl: url,
                protocol: parsed.protocol.replace(':', ''),
                domain: parsed.hostname,
                path: parsed.pathname + parsed.search + parsed.hash, // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø± Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
                length: url.length,
                isHttps: parsed.protocol === 'https:',
                isShortened: /bit\.ly|t\.co|tinyurl|goo\.gl|cutt\.ly|cli\.gs|t\.ly/i.test(url)
            };
        } catch (e) {
            return null;
        }
    }

    async function handleScan() {
        const url = urlInput.value.trim();

        if (!url) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ù„Ù„ÙØ­Øµ');
            return;
        }

        const urlDetails = parseUrl(url);

        if (!urlDetails) {
            alert('ØµÙŠØºØ© Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ­ÙŠØ­Ø©.');
            return;
        }

        scanButton.disabled = true;
        scanButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...';
        resultBox.style.display = 'none';

        // ---------------------------------------------------------------------------------
        // *** ğŸ”´ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø­Ø±Ø¬Ø©: Ù…Ù†Ø·Ù‚ Ø§Ù„ÙØ­Øµ Ø§Ù„Ø£ÙƒØ«Ø± Ø¹Ø¯ÙˆØ§Ù†ÙŠØ© ğŸ”´ ***
        // ---------------------------------------------------------------------------------

        let securityLevel = 'safe'; 
        let suspiciousPatterns = [];
        
        // ********** Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ ÙŠÙ…Ø«Ù„ Ù‚ÙˆØ© ÙØ­Øµ Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø§Ù„Ø¢Ù† **********

        // Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ³Ø¹Ø© Ù„Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¢Ù…Ù†Ø© Ø¬Ø¯Ø§Ù‹ (UltraSafe Domains)
        const ultraSafeDomains = [
            'google.com', 'youtube.com', 'facebook.com', 'twitter.com', 'instagram.com', 
            'tiktok.com', 'apple.com', 'samsung.com', 'huawei.com', 'amazon.sa', 'amazon.com', 
            'whatsapp.com', 'github.com', 'microsoft.com', 'speedtest.net', 'wikipedia.org', 
            'linkedin.com', 'reddit.com', 'cisco.com', 'bing.com', 'yahoo.com', 'netflix.com', 
            'paypal.com', 'ebay.com', 'adobe.com', 'oracle.com', 'ibm.com', 'dell.com', 'hp.com',
            'alipay.com', 'tencent.com', 'baidu.com', 'weibo.com', 'vk.com',
            
            // Ù…ÙˆØ§Ù‚Ø¹ Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØªØ¹Ù„ÙŠÙ…ÙŠØ© ÙˆØ®Ø¯Ù…ÙŠØ© Ø³Ø¹ÙˆØ¯ÙŠØ© Ù…ÙˆØ³Ø¹Ø© ÙˆÙ…Ø·Ù„ÙˆØ¨Ø©
            'gov.sa', 'edu.sa', 'saudibanks.sa', 'stc.com.sa', 'mobily.com.sa', 'zeker.sa', 
            'absher.sa', 'elm.sa', 'mof.gov.sa', 'cma.org.sa', 'sama.gov.sa', 'moe.gov.sa',
            'kfupm.edu.sa', 'ksu.edu.sa', 'tuwaiq.edu.sa', 'mcit.gov.sa', 'nic.gov.sa', 
            'yesser.gov.sa', 'saudi.gov.sa', 'tvtc.gov.sa', 'tvtclms.edu.sa' // Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙŠ Ø·Ù„Ø¨ØªÙ‡Ø§
        ];
        
        const domainToCheck = urlDetails.domain.toLowerCase();
        const cleanDomain = domainToCheck.startsWith('www.') ? domainToCheck.substring(4) : domainToCheck;
        
        const isExactMatch = ultraSafeDomains.some(d => cleanDomain === d);


        // 1. ÙØ­Øµ Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ (HTTP ØºÙŠØ± Ù…Ø´ÙØ± ÙŠØ¹ØªØ¨Ø± Ù…Ø¤Ø´Ø± Ø®Ø·Ø± ÙƒØ§ÙÙ)
        if (urlDetails.protocol === 'http') {
            suspiciousPatterns.push('Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…Ø´ÙÙ‘Ø± (HTTP) ÙˆÙŠØ³Ù‡Ù„ Ø§Ø¹ØªØ±Ø§Ø¶ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡. **(Ø®Ø·Ø± Ø¹Ø§Ù„ÙŠ)**');
        }

        // 2. ÙØ­Øµ Ø§Ù„Ø§Ø®ØªØµØ§Ø± (ÙŠØ¹ØªØ¨Ø± Ù…Ø¤Ø´Ø± Ø®Ø·Ø± ÙƒØ§ÙÙ Ù„ÙˆØ­Ø¯Ù‡)
        if (urlDetails.isShortened) {
            suspiciousPatterns.push('Ø§Ù„Ø±Ø§Ø¨Ø· Ù…ÙØ®ØªØµØ±ØŒ Ù…Ù…Ø§ ÙŠÙØµØ¹Ù‘Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØ¬Ù‡Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©. **(Ø®Ø·Ø± Ø¹Ø§Ù„ÙŠ)**');
        }

        // 3. ÙØ­Øµ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© ÙÙŠ Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„ ÙˆØ§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ø¶Ø§Ø±Ø© (Phishing/Malware)
        const suspiciousWords = ['scam', 'login-verify', 'free-soft', 'update-now', 'payment-failed', 'security-alert', 'download-exe', 'account-sync', 'support-fix'];
        const lowerCaseUrl = url.toLowerCase();
        
        suspiciousWords.forEach(word => {
            if (lowerCaseUrl.includes(word)) {
                suspiciousPatterns.push(`Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø© Ù…ÙØªØ§Ø­ÙŠØ© Ù…Ø´Ø¨ÙˆÙ‡Ø©: "${word}".`);
            }
        });

        // 4. *** Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ù‚ØµÙˆÙ‰ + Ø§Ù„Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ù„Ø¹Ø§Ù… ***
        
        // 4-Ø£. ÙØ­Øµ Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ù†Ø·Ø§Ù‚ (Typosquatting) - ÙŠÙƒØ´Ù ØªØºÙŠÙŠØ± Ø­Ø±Ù ÙˆØ§Ø­Ø¯ ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚
        let isTyposquattingDetected = false;

        for (const safeDomain of ultraSafeDomains) {
            const tldIndex = cleanDomain.lastIndexOf('.');
            const nameToCheck = tldIndex > 0 ? cleanDomain.substring(0, tldIndex) : cleanDomain;
            
            const safeTldIndex = safeDomain.lastIndexOf('.');
            const safeName = safeTldIndex > 0 ? safeDomain.substring(0, safeTldIndex) : safeDomain;
            
            const distance = getEditDistance(nameToCheck, safeName);

            // Ø§Ù„Ø´Ø±Ø· Ø§Ù„Ø­Ø§Ø³Ù…: Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø§Ø®ØªÙ„Ø§Ù Ø­Ø±Ù ÙˆØ§Ø­Ø¯ (Ù…Ø³Ø§ÙØ© = 1)ØŒ ÙØ¥Ù†Ù‡ Ø®Ø·Ø± Ø¨Ù†Ø³Ø¨Ø© 100%
            if (distance === 1) { 
                suspiciousPatterns.push(`Ø§Ù„Ù†Ø·Ø§Ù‚ Ù‚Ø±ÙŠØ¨ Ø¬Ø¯Ø§Ù‹ Ù…Ù† Ù†Ø·Ø§Ù‚ Ù…Ø´Ù‡ÙˆØ± (${safeDomain}) Ø¨Ø§Ø®ØªÙ„Ø§Ù Ø­Ø±Ù ÙˆØ§Ø­Ø¯ØŒ ÙˆÙ‡Ùˆ Ù…Ø¤Ø´Ø± Ù‚Ø§Ø·Ø¹ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ù†Ø·Ø§Ù‚ (Typosquatting).`);
                isTyposquattingDetected = true;
                securityLevel = 'danger'; 
                break; 
            }
        }

        // 4-Ø¨. *** Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø­Ø§Ø³Ù…Ø©: Ø£ÙŠ Ù†Ø·Ø§Ù‚ ØºÙŠØ± Ù…Ø·Ø§Ø¨Ù‚ Ø¨Ø§Ù„Ø¶Ø¨Ø· ÙŠØ¹ØªØ¨Ø± Ù…Ø´Ø¨ÙˆÙ‡Ù‹Ø§ ***
        // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ù†Ø·Ø§Ù‚ Ù…Ø·Ø§Ø¨Ù‚Ø§Ù‹ ØªÙ…Ø§Ù…Ø§Ù‹ Ù„Ø£Ø­Ø¯ Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¢Ù…Ù†Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
        if (!isExactMatch) { 
             const domainNoTLD = cleanDomain.substring(0, cleanDomain.lastIndexOf('.'));
             const digitCount = (domainNoTLD.match(/\d/g) || []).length;
             const hyphenCount = (domainNoTLD.match(/-/g) || []).length;
             const suspiciousChars = /[^a-z0-9-.]/.test(cleanDomain);

             if (!isTyposquattingDetected) {
                // Ù†Ø±ÙØ¹ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø§Ø´ØªØ¨Ø§Ù‡ Ø¨Ø´ÙƒÙ„ Ø¹Ø§Ù… Ù„Ø£ÙŠ Ù†Ø·Ø§Ù‚ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ 
                if (digitCount > 0) {
                    suspiciousPatterns.push('Ø§Ù„Ù†Ø·Ø§Ù‚ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ ÙˆÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø±Ù‚Ø§Ù… ÙÙŠ Ø§Ù„Ø§Ø³Ù….');
                }
                
                if (hyphenCount > 0) {
                     suspiciousPatterns.push('Ø§Ù„Ù†Ø·Ø§Ù‚ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ ÙˆÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø´Ø±Ø·Ø§Øª (-).');
                }
                
                if (cleanDomain.length > 35) {
                     suspiciousPatterns.push('Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹ (Ø£ÙƒØ«Ø± Ù…Ù† 35 Ø­Ø±ÙØ§Ù‹) ÙˆÙ…Ø¬Ù‡ÙˆÙ„.');
                }
             }

             // Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø±Ù…ÙˆØ² ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­Ø©
             if (suspiciousChars) {
                 suspiciousPatterns.push('ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø±Ù…ÙˆØ² Ø£Ùˆ Ø£Ø­Ø±Ù ØºÙŠØ± Ù‚ÙŠØ§Ø³ÙŠØ© ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ (Ù‚Ø¯ ØªÙƒÙˆÙ† Ø±Ù…ÙˆØ² Punycode Ø£Ùˆ Unicode Ù„Ù„ØªØ¶Ù„ÙŠÙ„).');
             }

             // *** Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: Ø¬Ø¹Ù„ Ø£ÙŠ Ù†Ø·Ø§Ù‚ ØºÙŠØ± Ù…Ø·Ø§Ø¨Ù‚ Ø¨Ø§Ù„Ø¶Ø¨Ø· Ù…Ø´Ø¨ÙˆÙ‡Ù‹Ø§ Ù„ÙˆØ¬ÙˆØ¯ Ø£ÙŠ Ø¹Ù„Ø§Ù…Ø© ***
             if (suspiciousPatterns.length > 0) {
                securityLevel = 'danger'; 
             }
        }
        
        // 5. *** Ù‚Ø§Ø¹Ø¯Ø© ÙØ­Øµ Ø¨ØµÙ…Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª (Google ACLK - Ø­Ø³Ø§Ø³ÙŠØ© ÙØ§Ø¦Ù‚Ø© Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø·ÙˆÙŠÙ„) ***
        if (domainToCheck.includes('google.com') && url.includes('/aclk?')) {
            // ÙØ­Øµ Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ ÙÙŠ Ø·ÙˆÙ„ Ù…Ø³Ø§Ø± Ø§Ù„ØªØªØ¨Ø¹ Ø¹Ù„Ù‰ Google
            if (urlDetails.path.length < 50 || urlDetails.path.length > 700) {
                 suspiciousPatterns.push('Ø·ÙˆÙ„ Ù…Ø³Ø§Ø± Ø§Ù„ØªØªØ¨Ø¹ Ø¹Ù„Ù‰ Google ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ (Ø¥Ø¶Ø§ÙØ© Ø£Ùˆ Ø­Ø°Ù ÙƒØ¨ÙŠØ± ÙÙŠ Ø§Ù„Ø¨ØµÙ…Ø©).');
                 securityLevel = 'danger';
            }
            
            // ÙØ­Øµ Ø±Ù…ÙˆØ² ØºÙŠØ± Ù…Ø£Ù„ÙˆÙØ© Ø£Ùˆ Ù…ÙÙ‚ÙˆØ¯ Ø¬Ø²Ø¡ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ (&sig)
            if (urlDetails.path.includes('//') || urlDetails.path.includes('..') || !urlDetails.path.includes('&sig=')) {
                suspiciousPatterns.push('ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø±Ù…ÙˆØ² ØºÙŠØ± Ù…Ø£Ù„ÙˆÙØ© Ø£Ùˆ Ù…ÙÙ‚ÙˆØ¯ Ø¬Ø²Ø¡ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ (&sig) ÙÙŠ Ù…Ø³Ø§Ø± Ø§Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø·ÙˆÙŠÙ„.');
                 securityLevel = 'danger';
            }
        }
        
        // 6. *** Ù‚Ø§Ø¹Ø¯Ø© ÙØ­Øµ Ø­Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø± (ABS, TVTC, AMAZON ÙˆØºÙŠØ±Ù‡Ù… Ù…Ù† Ø§Ù„Ø¢Ù…Ù†ÙŠÙ†) ***
        // Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© ØªØ¶Ù…Ù† Ø£Ù† Ø£ÙŠ ØªØºÙŠÙŠØ± ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø± (Ù…Ø«Ù„ / / . -) ÙŠØ¹ØªØ¨Ø± Ù…Ø¤Ø´Ø± Ø®Ø·Ø± Ù„Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¢Ù…Ù†Ø©
        if (isExactMatch && urlDetails.path !== '/') {
            const path = urlDetails.path;
            
            // Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø·ÙˆÙŠÙ„Ø© Ø¨Ø´ÙƒÙ„ ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¢Ù…Ù†Ø©
            if (urlDetails.length > 80 && !url.includes('watch?v=') && !url.includes('/aclk?')) {
                // Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø±ÙˆØ§Ø¨Ø· Ø¬ÙˆØ¬Ù„ Ø§Ù„Ø·ÙˆÙŠÙ„Ø© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© Ø§Ù„ØªÙŠ ØªÙ… ÙØ­ØµÙ‡Ø§ ÙÙŠ Ø§Ù„Ù†Ù‚Ø·Ø© 5
                suspiciousPatterns.push('Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù†Ø·Ø§Ù‚ Ø¢Ù…Ù† ÙˆÙ„ÙƒÙ†Ù‡ Ø·ÙˆÙŠÙ„ Ø¨Ø´ÙƒÙ„ ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠØŒ Ù‚Ø¯ ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø®ÙØ§Ø¡ Ù…Ø³Ø§Ø± Ø§Ø­ØªÙŠØ§Ù„ÙŠ Ø£Ùˆ ØªØªØ¨Ø¹.');
            }

            // ÙØ­Øµ ÙˆØ¬ÙˆØ¯ ØªÙ„Ø§Ø¹Ø¨ ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª (Ù…Ø«Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù…ÙˆØ² ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠØ©: ØªÙƒØ±Ø§Ø± /ØŒ Ø£Ùˆ ..)
            if (path.includes('../') || path.includes('//')) {
                suspiciousPatterns.push('Ø§Ù„Ù…Ø³Ø§Ø± ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø±Ù…ÙˆØ² ØºÙŠØ± Ø¹Ø§Ø¯ÙŠØ© (Ù…Ø«Ù„ // Ø£Ùˆ ../) ØªØ³ØªØ®Ø¯Ù… ÙÙŠ Ù‡Ø¬Ù…Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª.');
            }

            // ÙØ­Øµ Ø§Ù„Ù…Ø³Ø§Ø± Ø¨Ø­Ø«Ø§Ù‹ Ø¹Ù† Ø£Ø±Ù‚Ø§Ù… Ø£Ùˆ Ø±Ù…ÙˆØ² ØºÙŠØ± Ù…Ø£Ù„ÙˆÙØ© ÙÙŠ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¨ÙˆØ§Ø¨Ø§Øª
            // Absher.sa/wps/portal/business/Home/homepublic/!ut/p/z1/04_Sj9CPykssy0xPLMnMz0vMAfIjo8ziDTxNTDwMTYy8LXx9jAwcnQI9nYK9gwwMTMz0wwkpiAJJ4wCOBkD9UViUOBo4BRk5GRsYuPsbYVWAYkZBboRBpqOiIgCyIDAO/dz/d5/L0lDUmlTUSEhL3dHa0FKRnNBLzROV3FpQSEhL2Fy/
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³Ø§Ø± ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø±Ù…ÙˆØ² Ù…Ø¹Ù‚Ø¯Ø© Ø¬Ø¯Ø§Ù‹ (Ù…Ø«Ù„ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¨ÙˆØ§Ø¨Ø§Øª Ø§Ù„Ø·ÙˆÙŠÙ„Ø©) ÙˆÙ„ÙƒÙ† ØªÙ… ØªØºÙŠÙŠØ±Ù‡Ø§ Ø¨Ø´ÙƒÙ„ Ø·ÙÙŠÙ (Ø£ÙƒØ«Ø± Ù…Ù† 3 Ø­Ø±ÙˆÙ ÙØ±Ù‚Ø§Ù‹ Ø¹Ù† Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø£ØµÙ„ÙŠ Ø§Ù„Ù…Ø¹Ø±ÙˆÙ)
             if (cleanDomain.includes('absher.sa') || cleanDomain.includes('tvtc.gov.sa')) {
                const knownAbsherPath = '/wps/portal/business'; 
                const knownTvtcPath = '/ar/Departments'; 
                
                // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ† ØªØ·Ø¨ÙŠÙ‚ Ù…Ù‚Ø§Ø±Ù†Ø© Ø¯Ù‚ÙŠÙ‚Ø© Ù„Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆÙØ© Ù„Ø¶Ù…Ø§Ù† Ø£ÙŠ ØªØºÙŠÙŠØ± ÙÙŠÙ‡Ø§ ÙŠÙƒØªØ´Ù ÙƒØ®Ø·Ø±
                
                if ((cleanDomain.includes('absher.sa') && getEditDistance(path.substring(0, 20), knownAbsherPath.substring(0, 20)) > 3) || 
                    (cleanDomain.includes('tvtc.gov.sa') && getEditDistance(path.substring(0, 20), knownTvtcPath.substring(0, 20)) > 3)) {
                     suspiciousPatterns.push('ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø³ÙŠØ· (Ø­Ø±Ù/Ø±Ù…Ø²) ÙÙŠ Ù…Ø³Ø§Ø± Ø¨ÙˆØ§Ø¨Ø© Ø­ÙƒÙˆÙ…ÙŠØ© Ù…Ø¹Ø±ÙˆÙØ© (Absher/TVTC).');
                }
             }

            // Ø¥Ø°Ø§ Ø£Ø¸Ù‡Ø± Ø§Ù„Ù…Ø³Ø§Ø± Ø£ÙŠ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§ØªØŒ ÙŠØ±ØªÙØ¹ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·Ø±
            if (suspiciousPatterns.some(p => p.includes('Ø§Ù„Ù…Ø³Ø§Ø± ÙŠØ­ØªÙˆÙŠ') || p.includes('Ø±Ù…ÙˆØ² ØºÙŠØ± Ø¹Ø§Ø¯ÙŠØ©') || p.includes('ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø³ÙŠØ·'))) {
                securityLevel = 'danger';
            }
        }
        
        // 7. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø±Ø§Ø¨Ø· EICAR
        if (url.includes('wicar.org')) {
            securityLevel = 'danger';
            suspiciousPatterns.push('ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· ÙƒÙ…Ù„Ù Ø§Ø®ØªØ¨Ø§Ø± Ø¶Ø§Ø± (EICAR).');
        }

        // 8. Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: Ø£ÙŠ Ù…Ø¤Ø´Ø± Ø®Ø·Ø± ÙˆØ§Ø­Ø¯ ÙŠØ¹Ù†ÙŠ "Ø®Ø·Ø±"
        if (securityLevel === 'danger' || suspiciousPatterns.length >= 1) {
            securityLevel = 'danger';
        } else {
            securityLevel = 'safe'; 
        } 
        
        // ********** Ù†Ù‡Ø§ÙŠØ© Ù…Ù†Ø·Ù‚ Ù‚ÙˆØ© ÙØ­Øµ Ù…Ø´Ø±ÙˆØ¹Ùƒ **********

        // ---------------------------------------------------------------------------------
        
        await new Promise(resolve => setTimeout(resolve, 1500));


        displayResult(securityLevel, urlDetails, suspiciousPatterns);
        scanButton.disabled = false;
        scanButton.innerHTML = '<i class="fas fa-skull-crossbones"></i> ÙØ­Øµ Ø¹Ø¯ÙˆØ§Ù†ÙŠ';
    }

    function displayResult(level, details, patterns) {
        resultBox.className = 'result-box';
        resultBox.classList.add(level);
        
        let iconHtml;
        let statusText;

        if (level === 'safe') {
            iconHtml = '<i class="fas fa-shield-alt"></i>';
            statusText = 'Ø¢Ù…Ù† ØªÙ…Ø§Ù…Ø§Ù‹';
        } else {
            iconHtml = '<i class="fas fa-hand-paper"></i>';
            statusText = 'Ø®Ø·Ø± / Ù…Ø´Ø¨ÙˆÙ‡';
        }
        
        let warningsHtml = '';
        if (patterns.length > 0) {
            const listItems = patterns.map(p => `<li>${p}</li>`).join('');
            warningsHtml = `
                <div class="warnings-list">
                    <p class="warnings-title">ğŸ”´ ØªÙ… Ø§ÙƒØªØ´Ø§Ù (${patterns.length}) Ù…Ø¤Ø´Ø± Ø®Ø·Ø±:</p>
                    <ul>${listItems}</ul>
                </div>
            `;
        } else if (level === 'safe') {
            warningsHtml = `<div class="warnings-list safe" style="border-color:#059669; background-color:#ECFDF5;">
                <p class="warnings-title" style="color:#059669;">âœ… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ù…Ø§Ù†: Ù…Ø·Ø§Ø¨Ù‚ ØªÙ…Ø§Ù…Ø§Ù‹ Ù„Ù†Ø·Ø§Ù‚ Ø¢Ù…Ù† ÙˆÙ„Ø§ ÙŠÙˆØ¬Ø¯ Ø§Ø´ØªØ¨Ø§Ù‡.</p>
            </div>`;
        }

        resultBox.innerHTML = `
            <div class="result-header">
                ${iconHtml}
                <span class="result-status">${statusText}</span>
            </div>
            <p class="result-url">${details.fullUrl}</p>

            <div class="details-grid">
                <div class="detail-item">
                    <span class="detail-label">Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„:</span>
                    <span class="detail-value" style="color: ${details.isHttps ? '#059669' : '#DC2626'};">${details.protocol.toUpperCase()}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Ø§Ù„Ù†Ø·Ø§Ù‚:</span>
                    <span class="detail-value" dir="ltr">${details.domain}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Ø·ÙˆÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·:</span>
                    <span class="detail-value">${details.length} Ø­Ø±Ù</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Ø§Ø®ØªØµØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø·:</span>
                    <span class="detail-value" style="color: ${details.isShortened ? '#F59E0B' : '#059669'};">${details.isShortened ? 'Ù†Ø¹Ù… (Ù…Ø´Ø¨ÙˆÙ‡)' : 'Ù„Ø§'}</span>
                </div>
            </div>

            ${warningsHtml}
        `;
        resultBox.style.display = 'block';
    }
</script>

</body>
</html>
