<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AetherScan - ÙØ§Ø­Øµ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        /* (*** Ø§Ù„Ø£Ù†Ù…Ø§Ø· CSS ÙƒÙ…Ø§ Ù‡ÙŠ Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± ***) */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #F8FAFC;
            color: #1F2937;
            text-align: right;
            padding: 20px;
        }
        .container {
            max-width: 700px;
            margin: 40px auto;
            background-color: #ffffff;
            padding: 40px;
            border-radius: 24px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #059669;
            font-size: 2.5em;
            text-align: center;
            margin-bottom: 5px;
            font-weight: 800;
        }
        .subtitle {
            text-align: center;
            color: #6B7280;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }
        #urlInput {
            flex-grow: 1;
            padding: 18px;
            border: 2px solid #D1D5DB;
            border-radius: 12px;
            font-size: 17px;
            text-align: right;
            transition: border-color 0.3s;
        }
        #urlInput:focus {
            border-color: #059669;
            outline: none;
        }
        #scanButton {
            background-color: #059669;
            color: white;
            border: none;
            padding: 0 30px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 700;
            transition: background-color 0.3s, transform 0.1s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        #scanButton:hover {
            background-color: #047857;
        }
        #scanButton:active {
            transform: scale(0.98);
        }
        #scanButton:disabled {
            background-color: #9CA3AF;
            cursor: not-allowed;
        }
        .result-box {
            padding: 25px;
            border-radius: 16px;
            margin-top: 25px;
            animation: fadeIn 0.6s ease-out;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            display: none;
        }
        .result-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .result-status {
            font-size: 1.8em;
            font-weight: 800;
        }
        .result-url {
            font-size: 1em;
            color: #6B7280;
            direction: ltr;
            text-align: left;
            word-break: break-all;
            margin-bottom: 15px;
        }
        .safe {
            background-color: #ECFDF5;
            border: 3px solid #10B981;
        }
        .safe .result-status {
            color: #059669;
        }
        .safe i {
            color: #059669;
        }
        .danger {
            background-color: #FEF2F2;
            border: 3px solid #EF4444;
        }
        .danger .result-status {
            color: #DC2626;
        }
        .danger i {
            color: #DC2626;
        }
        .details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        .detail-item {
            background-color: #F3F4F6;
            padding: 15px;
            border-radius: 10px;
            font-size: 0.95em;
        }
        .detail-label {
            color: #6B7280;
            font-weight: 600;
            margin-bottom: 5px;
            display: block;
        }
        .detail-value {
            font-weight: 700;
            color: #1F2937;
        }
        .warnings-list {
            margin-top: 14px;
            padding: 14px;
            background-color: #FEE2F2;
            border: 1px solid #FCA5A5;
            border-radius: 10px;
        }
        .warnings-title {
            color: #DC2626;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .warnings-list ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .warnings-list li {
            color: #991B1B;
            margin-bottom: 8px;
            position: relative;
            padding-right: 15px;
        }
        .warnings-list li::before {
            content: 'â€¢';
            color: #DC2626;
            font-size: 1.2em;
            position: absolute;
            right: 0;
            top: 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

<div class="container">
    <h1><i class="fas fa-satellite-dish"></i> AetherScan</h1>
    <p class="subtitle">ÙØ­Øµ Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ø£Ù…Ø§Ù† Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù†ÙŠØ© ÙˆØ§Ù„Ù…ÙŠØ²Ø§Øª</p>

    <div class="input-group">
        <input type="url" id="urlInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· ÙƒØ§Ù…Ù„Ø§Ù‹ Ù‡Ù†Ø§..." value="" />
        <button id="scanButton"><i class="fas fa-search"></i> ÙØ­Øµ Ù…ØªÙ‚Ø¯Ù…</button>
    </div>

    <div id="resultBox" class="result-box">
        </div>
</div>

<script>
    // ********* Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ù…Ø³Ø§ÙØ© Ù„ÙŠÙÙ†Ø´ØªØ§ÙŠÙ† (Levenshtein Distance) *********
    function getEditDistance(a, b) {
      if (a.length === 0) return b.length;
      if (b.length === 0) return a.length;

      const matrix = [];

      for (let i = 0; i <= b.length; i++) {
        matrix[i] = [i];
      }

      for (let j = 0; j <= a.length; j++) {
        matrix[0][j] = j;
      }

      for (let i = 1; i <= b.length; i++) {
        for (let j = 1; j <= a.length; j++) {
          if (b.charAt(i - 1) === a.charAt(j - 1)) {
            matrix[i][j] = matrix[i - 1][j - 1];
          } else {
            matrix[i][j] = Math.min(
              matrix[i - 1][j - 1] + 1, // Ø§Ø³ØªØ¨Ø¯Ø§Ù„
              matrix[i][j - 1] + 1, // Ø¥Ø¯Ø®Ø§Ù„
              matrix[i - 1][j] + 1 // Ø­Ø°Ù
            );
          }
        }
      }

      return matrix[b.length][a.length];
    }
    // *******************************************************************


    const urlInput = document.getElementById('urlInput');
    const scanButton = document.getElementById('scanButton');
    const resultBox = document.getElementById('resultBox');

    scanButton.addEventListener('click', handleScan);

    function parseUrl(url) {
        try {
            const link = url.startsWith('http') ? url : `http://${url}`;
            const parsed = new URL(link);
            return {
                fullUrl: url,
                protocol: parsed.protocol.replace(':', ''),
                domain: parsed.hostname,
                length: url.length,
                isHttps: parsed.protocol === 'https:',
                isShortened: /bit\.ly|t\.co|tinyurl|goo\.gl|cutt\.ly|cli\.gs|t\.ly/i.test(url)
            };
        } catch (e) {
            return null;
        }
    }

    async function handleScan() {
        const url = urlInput.value.trim();

        if (!url) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ù„Ù„ÙØ­Øµ');
            return;
        }

        const urlDetails = parseUrl(url);

        if (!urlDetails) {
            alert('ØµÙŠØºØ© Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ­ÙŠØ­Ø©.');
            return;
        }

        scanButton.disabled = true;
        scanButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...';
        resultBox.style.display = 'none';

        // ---------------------------------------------------------------------------------
        // *** ğŸ”´ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø­Ø±Ø¬Ø©: Ù…Ù†Ø·Ù‚ Ø§Ù„ÙØ­Øµ Ø§Ù„Ù‚ÙˆÙŠ (Ù…Ø­Ø§ÙƒØ§Ø©/Ø¯Ù…Ø¬ Rork) ğŸ”´ ***
        // ---------------------------------------------------------------------------------

        let securityLevel = 'safe'; 
        let suspiciousPatterns = [];
        
        // ********** Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ ÙŠÙ…Ø«Ù„ Ù‚ÙˆØ© ÙØ­Øµ Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø§Ù„Ø¢Ù† **********

        // Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¢Ù…Ù†Ø© (Ù„Ù† ÙŠØªÙ… ÙØ­ØµÙ‡Ø§ Ø¨Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø§Ø´ØªØ¨Ø§Ù‡ Ø¨Ø§Ù„Ù†Ø·Ø§Ù‚ØŒ ÙÙ‚Ø· Ø¨Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©)
        const ultraSafeDomains = [
            'google.com', 'youtube.com', 'facebook.com', 'twitter.com', 'instagram.com', 
            'tiktok.com', 'apple.com', 'amazon.com', 'whatsapp.com', 'github.com', 'microsoft.com',
            'speedtest.net', 'wikipedia.org', 'linkedin.com', 'reddit.com',
            'cisco.com', 'gov.sa', 'edu.sa', 'bing.com' // Ø¥Ø¶Ø§ÙØ© Ù†Ø·Ø§Ù‚Ø§Øª Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ´Ø§Ø¦Ø¹Ø©
        ];
        
        const domainToCheck = urlDetails.domain.toLowerCase();
        const cleanDomain = domainToCheck.startsWith('www.') ? domainToCheck.substring(4) : domainToCheck;
        
        const isUltraSafe = ultraSafeDomains.some(d => cleanDomain === d);


        // 1. ÙØ­Øµ Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ (HTTP ØºÙŠØ± Ù…Ø´ÙØ± ÙŠØ¹ØªØ¨Ø± Ù…Ø¤Ø´Ø± Ø®Ø·Ø± ÙƒØ§ÙÙ)
        if (urlDetails.protocol === 'http') {
            suspiciousPatterns.push('Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…Ø´ÙÙ‘Ø± (HTTP) ÙˆÙŠØ³Ù‡Ù„ Ø§Ø¹ØªØ±Ø§Ø¶ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡. **(Ø®Ø·Ø± Ø¹Ø§Ù„ÙŠ)**');
        }

        // 2. ÙØ­Øµ Ø§Ù„Ø§Ø®ØªØµØ§Ø± (ÙŠØ¹ØªØ¨Ø± Ù…Ø¤Ø´Ø± Ø®Ø·Ø± ÙƒØ§ÙÙ Ù„ÙˆØ­Ø¯Ù‡)
        if (urlDetails.isShortened) {
            suspiciousPatterns.push('Ø§Ù„Ø±Ø§Ø¨Ø· Ù…ÙØ®ØªØµØ±ØŒ Ù…Ù…Ø§ ÙŠÙØµØ¹Ù‘Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØ¬Ù‡Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©. **(Ø®Ø·Ø± Ø¹Ø§Ù„ÙŠ)**');
        }

        // 3. ÙØ­Øµ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© ÙÙŠ Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„ ÙˆØ§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ø¶Ø§Ø±Ø© (Phishing/Malware)
        const suspiciousWords = ['scam', 'login-verify', 'free-soft', 'update-now', 'payment-failed', 'security-alert', 'download-exe', 'account-sync', 'support-fix'];
        const lowerCaseUrl = url.toLowerCase();
        
        suspiciousWords.forEach(word => {
            if (lowerCaseUrl.includes(word)) {
                suspiciousPatterns.push(`Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø© Ù…ÙØªØ§Ø­ÙŠØ© Ù…Ø´Ø¨ÙˆÙ‡Ø©: "${word}".`);
            }
        });

        // 4. *** ğŸ†• Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: Ø§Ù„Ø§Ø´ØªØ¨Ø§Ù‡ Ø¨Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø¬Ø© (Ø¨Ù…Ø§ ÙÙŠÙ‡Ø§ Ø§Ù„ØªÙ„Ø§Ø¹Ø¨) ***
        if (!isUltraSafe) { // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ù†Ø·Ø§Ù‚ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¢Ù…Ù†Ø© Ø¬Ø¯Ø§Ù‹
            
            let isTyposquattingDetected = false;

            // 4-Ø£. ÙØ­Øµ Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ù†Ø·Ø§Ù‚ (Typosquatting)
            for (const safeDomain of ultraSafeDomains) {
                const tldIndex = cleanDomain.lastIndexOf('.');
                const nameToCheck = tldIndex > 0 ? cleanDomain.substring(0, tldIndex) : cleanDomain;
                
                const safeTldIndex = safeDomain.lastIndexOf('.');
                const safeName = safeTldIndex > 0 ? safeDomain.substring(0, safeTldIndex) : safeDomain;
                
                const distance = getEditDistance(nameToCheck, safeName);

                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø§Ø®ØªÙ„Ø§Ù Ø­Ø±Ù ÙˆØ§Ø­Ø¯ØŒ Ù†Ø¹ØªØ¨Ø±Ù‡ ØªÙ„Ø§Ø¹Ø¨Ø§Ù‹
                if (distance === 1) { 
                    suspiciousPatterns.push(`Ø§Ù„Ù†Ø·Ø§Ù‚ ØºÙŠØ± Ù…Ø·Ø§Ø¨Ù‚ (Ù‚Ø±ÙŠØ¨ Ø¬Ø¯Ø§Ù‹) Ù…Ù† Ù†Ø·Ø§Ù‚ Ù…Ø´Ù‡ÙˆØ± (${safeDomain}) Ø¨Ø§Ø®ØªÙ„Ø§Ù Ø­Ø±Ù ÙˆØ§Ø­Ø¯ØŒ ÙŠÙØ­ØªÙ…Ù„ Ø£Ù† ÙŠÙƒÙˆÙ† ØªÙ„Ø§Ø¹Ø¨Ø§Ù‹ (Typosquatting).`);
                    isTyposquattingDetected = true;
                    break;
                }
            }

            // 4-Ø¨. ÙØ­Øµ Ø§Ù„Ø§Ø´ØªØ¨Ø§Ù‡ ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ Ù†ÙØ³Ù‡ (Ù„Ø£ÙŠ Ù†Ø·Ø§Ù‚ ØºÙŠØ± Ù…Ø´Ù‡ÙˆØ±)
            if (!isTyposquattingDetected) {
                const domainNoTLD = cleanDomain.substring(0, cleanDomain.lastIndexOf('.'));
                const digitCount = (domainNoTLD.match(/\d/g) || []).length;
                const hyphenCount = (domainNoTLD.match(/-/g) || []).length;

                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù†Ø·Ø§Ù‚ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£ÙŠ Ø±Ù‚Ù… (Ø¨Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¢Ù…Ù†Ø© Ù…Ø«Ù„ 1010data.com)
                if (digitCount > 0) {
                    suspiciousPatterns.push('Ø§Ù„Ù†Ø·Ø§Ù‚ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø±Ù‚Ø§Ù… ÙÙŠ Ø§Ù„Ø§Ø³Ù…ØŒ ÙˆÙ‡ÙŠ Ø¹Ù„Ø§Ù…Ø© Ø´Ø§Ø¦Ø¹Ø© ÙÙŠ Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„ ØºÙŠØ± Ø§Ù„Ù…Ø¹Ø±ÙˆÙØ©.');
                }
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù†Ø·Ø§Ù‚ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø´Ø±Ø·Ø§Øª
                if (hyphenCount > 0) {
                     suspiciousPatterns.push('Ø§Ù„Ù†Ø·Ø§Ù‚ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø´Ø±Ø·Ø§Øª (-)ØŒ ÙˆÙ‡ÙŠ Ø¹Ù„Ø§Ù…Ø© Ø´Ø§Ø¦Ø¹Ø© ÙÙŠ Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„ Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒÙ„Ù…Ø§Øª.');
                }
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù†Ø·Ø§Ù‚ Ø·ÙˆÙŠÙ„Ø§Ù‹ Ø¨Ø´ÙƒÙ„ Ù…Ø¨Ø§Ù„Øº ÙÙŠÙ‡
                if (cleanDomain.length > 35) {
                     suspiciousPatterns.push('Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹ (Ø£ÙƒØ«Ø± Ù…Ù† 35 Ø­Ø±ÙØ§Ù‹).');
                }
            }
        }
        
        // 5. Ù‚Ø§Ø¹Ø¯Ø© ÙØ­Øµ Ø¨ØµÙ…Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª (Ù„Ø±ÙˆØ§Ø¨Ø· Ø¬ÙˆØ¬Ù„ Ø§Ù„Ø·ÙˆÙŠÙ„Ø©)
        if (domainToCheck.includes('google.com') && url.includes('/aclk?')) {
            const safeLinkSegment = 'DChsSEwj58NSUhtuQAxXdf0ECHWxODQkYACICCAEQARoCd3M';
            
            const startAnchor = url.indexOf('?sa=L&ai=');
            const endAnchor = url.indexOf('&co=1'); 
            
            if (startAnchor !== -1 && endAnchor !== -1 && endAnchor > startAnchor) {
                const userLinkSegment = url.substring(startAnchor + 9, endAnchor);

                const distance = getEditDistance(safeLinkSegment, userLinkSegment);

                // Ø£ÙŠ ØªØºÙŠÙŠØ± ÙŠØªØ¬Ø§ÙˆØ² 3 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¬ÙˆØ¬Ù„ ÙŠÙØ¹ØªØ¨Ø± ØªÙ„Ø§Ø¹Ø¨Ø§Ù‹
                if (distance > 3) { 
                    suspiciousPatterns.push('ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† ØªÙ„Ø§Ø¹Ø¨ ÙƒØ¨ÙŠØ± ÙÙŠ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ØªØªØ¨Ø¹ (Tracking Parameters) Ø¹Ù„Ù‰ Ù†Ø·Ø§Ù‚ Google Ø¢Ù…Ù†. **(Ø®Ø·Ø± Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ø¨ØµÙ…Ø©)**');
                }
            }
        }
        
        // 6. ÙØ­Øµ Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª (Ø²ÙŠØ§Ø¯Ø© Ø£Ùˆ Ù†Ù‚ØµØ§Ù† Ø¹Ø´ÙˆØ§Ø¦ÙŠ ÙÙŠ Ø±Ø§Ø¨Ø· Ø¢Ù…Ù†)
        // Ù‡Ø°Ø§ Ø§Ù„ÙØ­Øµ ÙŠÙƒØªØ´Ù Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ ÙÙŠ Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¢Ù…Ù†Ø© (Ù…Ø«Ù„ Ø¥Ø¶Ø§ÙØ© /virus-scan Ø¥Ù„Ù‰ youtube.com)
        if (isUltraSafe) {
            if (urlDetails.length > 80 && !url.includes('watch?v=') && !url.includes('search?q=')) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†Ø·Ø§Ù‚Ø§Ù‹ Ø¢Ù…Ù†Ø§Ù‹ Ù„ÙƒÙ† Ø§Ù„Ù…Ø³Ø§Ø± Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹ ÙˆÙ„ÙŠØ³ Ù…Ø³Ø§Ø± Ø¨Ø­Ø«/ÙÙŠØ¯ÙŠÙˆ
                suspiciousPatterns.push('Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ø¹Ø±ÙˆÙ (Ù†Ø·Ø§Ù‚ Ø¢Ù…Ù†) ÙˆÙ„ÙƒÙ†Ù‡ Ø·ÙˆÙŠÙ„ Ø¨Ø´ÙƒÙ„ ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠØŒ Ù‚Ø¯ ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø®ÙØ§Ø¡ Ù…Ø³Ø§Ø± Ø§Ø­ØªÙŠØ§Ù„ÙŠ Ø£Ùˆ ØªØªØ¨Ø¹.');
            }
        }
        
        // 7. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø±Ø§Ø¨Ø· EICAR
        if (url.includes('wicar.org')) {
            securityLevel = 'danger';
            suspiciousPatterns.push('ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· ÙƒÙ…Ù„Ù Ø§Ø®ØªØ¨Ø§Ø± Ø¶Ø§Ø± (EICAR).');
        }

        // 8. Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: Ø£ÙŠ Ù…Ø¤Ø´Ø± Ø®Ø·Ø± ÙˆØ§Ø­Ø¯ ÙŠØ¹Ù†ÙŠ "Ø®Ø·Ø±"
        if (securityLevel === 'danger' || suspiciousPatterns.length >= 1) {
            securityLevel = 'danger';
        } else {
            securityLevel = 'safe';
        } 
        
        // ********** Ù†Ù‡Ø§ÙŠØ© Ù…Ù†Ø·Ù‚ Ù‚ÙˆØ© ÙØ­Øµ Ù…Ø´Ø±ÙˆØ¹Ùƒ **********

        // ---------------------------------------------------------------------------------
        
        await new Promise(resolve => setTimeout(resolve, 1500));


        displayResult(securityLevel, urlDetails, suspiciousPatterns);
        scanButton.disabled = false;
        scanButton.innerHTML = '<i class="fas fa-search"></i> ÙØ­Øµ Ù…ØªÙ‚Ø¯Ù…';
    }

    function displayResult(level, details, patterns) {
        resultBox.className = 'result-box';
        resultBox.classList.add(level);
        
        let iconHtml;
        let statusText;

        if (level === 'safe') {
            iconHtml = '<i class="fas fa-check-circle"></i>';
            statusText = 'Ø¢Ù…Ù† ØªÙ…Ø§Ù…Ø§Ù‹';
        } else {
            iconHtml = '<i class="fas fa-exclamation-triangle"></i>';
            statusText = 'Ø®Ø·Ø± / Ù…Ø´Ø¨ÙˆÙ‡';
        }
        
        let warningsHtml = '';
        if (patterns.length > 0) {
            const listItems = patterns.map(p => `<li>${p}</li>`).join('');
            warningsHtml = `
                <div class="warnings-list">
                    <p class="warnings-title">ğŸ”´ ØªÙ… Ø§ÙƒØªØ´Ø§Ù (${patterns.length}) Ù…Ø¤Ø´Ø± Ø®Ø·Ø±:</p>
                    <ul>${listItems}</ul>
                </div>
            `;
        }

        resultBox.innerHTML = `
            <div class="result-header">
                ${iconHtml}
                <span class="result-status">${statusText}</span>
            </div>
            <p class="result-url">${details.fullUrl}</p>

            <div class="details-grid">
                <div class="detail-item">
                    <span class="detail-label">Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„:</span>
                    <span class="detail-value" style="color: ${details.isHttps ? '#059669' : '#DC2626'};">${details.protocol.toUpperCase()}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Ø§Ù„Ù†Ø·Ø§Ù‚:</span>
                    <span class="detail-value" dir="ltr">${details.domain}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Ø·ÙˆÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·:</span>
                    <span class="detail-value">${details.length} Ø­Ø±Ù</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Ø§Ø®ØªØµØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø·:</span>
                    <span class="detail-value" style="color: ${details.isShortened ? '#F59E0B' : '#059669'};">${details.isShortened ? 'Ù†Ø¹Ù… (Ù…Ø´Ø¨ÙˆÙ‡)' : 'Ù„Ø§'}</span>
                </div>
            </div>

            ${warningsHtml}
        `;
        resultBox.style.display = 'block';
    }
</script>

</body>
</html>
